<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Baseball Bingo</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;700&display=swap" rel="stylesheet">
    <style>
        /* General Body Styling */
        body {
            font-family: 'Inter', sans-serif;
            background-color: #003366; /* Deep Blue - Rangers primary blue */
            color: #FFFFFF; /* White text */
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: flex-start;
            min-height: 100vh;
            margin: 0;
            padding: 20px 10px;
            box-sizing: border-box;
            overflow-y: auto; /* Allow scrolling for smaller screens */
        }

        /* Header */
        h1 {
            color: #CC0000; /* Red - Rangers primary red */
            margin-bottom: 20px;
            font-size: 2.2em;
            text-align: center;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.3);
            border-bottom: 3px solid #FFFFFF;
            padding-bottom: 10px;
        }

        /* Bingo Grid Container */
        #bingo-grid {
            display: grid;
            grid-template-columns: repeat(5, 1fr);
            grid-template-rows: repeat(5, 1fr);
            grid-auto-rows: 1fr;
            gap: 8px; /* Spacing between cells */
            width: 100vw;
            max-width: 90vw; /* Max width for larger screens, responsive */
            background-color: #ADD8E6; /* Light blue background for the grid area */
            padding: 8px;
            border-radius: 15px; /* Rounded corners for the grid */
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.4);
            margin-bottom: 25px;
            /* aspect-ratio: 1 / 1; Maintain square aspect ratio */
        }

        /* Bingo Cell Styling */
        .bingo-cell {
            background-color: #FFFFFF; /* White cell background */
            color: #003366; /* Dark blue text for cells */
            display: flex;
            align-items: center;
            justify-content: center;
            text-align: center;
            padding: 5px;
            border-radius: 10px; /* Rounded corners for cells */
            font-size: 0.9em; /* Responsive font size */
            font-weight: bold;
            cursor: pointer;
            user-select: none; /* Prevent text selection */
            transition: background-color 0.2s ease, transform 0.1s ease; /* Smooth transitions */
            border: 2px solid #CC0000; /* Red border */
            box-shadow: inset 0 2px 5px rgba(0, 0, 0, 0.1);
            aspect-ratio: 1 / 1;
            width: 100%;
        }

        /* Marked Cell Styling */
        .bingo-cell.marked {
            background-color: #CC0000; /* Red when marked */
            color: #FFFFFF; /* White text on marked cells */
            border-color: #003366; /* Dark blue border when marked */
            transform: scale(0.98); /* Slight shrink on mark */
            box-shadow: inset 0 2px 5px rgba(0, 0, 0, 0.3);
        }

        /* Hover effect for cells */
        .bingo-cell:not(.marked):hover {
            background-color: #ffe6e6; /* Light red on hover */
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
        }

        /* Message Display */
        #message {
            font-size: 1.8em;
            font-weight: bold;
            color: #FFD700; /* Gold for emphasis */
            text-shadow: 1px 1px 3px rgba(0, 0, 0, 0.5);
            margin-top: 15px;
            height: 40px; /* Reserve space to prevent layout shifts */
            text-align: center;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: opacity 0.5s ease;
        }

        /* Button Container */
        .button-container {
            display: flex;
            flex-wrap: wrap; /* Allow wrapping on smaller screens */
            justify-content: center;
            gap: 15px;
            margin-top: 20px;
            width: 100%;
            max-width: 400px;
        }

        /* Button Styling */
        .game-button {
            background-color: #CC0000; /* Red button */
            color: white;
            padding: 12px 25px;
            border: none;
            border-radius: 50px; /* Pill-shaped buttons */
            font-size: 1.1em;
            font-weight: bold;
            cursor: pointer;
            transition: background-color 0.3s ease, transform 0.2s ease, box-shadow 0.3s ease;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
            text-transform: uppercase;
            letter-spacing: 0.5px;
            flex-grow: 1; /* Allow buttons to grow */
            min-width: 150px; /* Minimum width for buttons */
        }

        .game-button:hover {
            background-color: #a00; /* Darker red on hover */
            transform: translateY(-3px);
            box-shadow: 0 8px 20px rgba(0, 0, 0, 0.3);
        }

        .game-button:active {
            transform: translateY(0);
            box-shadow: 0 3px 10px rgba(0, 0, 0, 0.2);
        }

        /* Specific style for reset button */
        #reset-progress-btn {
            background-color: #003366; /* Blue reset button */
        }

        #reset-progress-btn:hover {
            background-color: #002244;
        }

        /* Responsive Adjustments */
        @media (max-width: 600px) {
            h1 {
                font-size: 1.8em;
                margin-bottom: 15px;
            }
            #bingo-grid {
                gap: 6px;
                padding: 6px;
                max-width: 100vw;
                width: 100vw;
            }
            .bingo-cell {
                font-size: 0.75em;
                padding: 3px;
                border-radius: 8px;
                aspect-ratio: 1 / 1;
                width: 100%;
            }
            .game-button {
                padding: 10px 20px;
                font-size: 1em;
                min-width: 130px;
            }
            .button-container {
                gap: 10px;
            }
            #message {
                font-size: 1.4em;
            }
        }

        @media (max-width: 360px) {
            h1 {
                font-size: 1.6em;
            }
            #bingo-grid {
                max-width: 280px;
            }
            .bingo-cell {
                font-size: 0.7em;
            }
            .game-button {
                min-width: unset; /* Allow buttons to shrink more if needed */
                width: 100%; /* Stack buttons if too narrow */
            }
            .button-container {
                flex-direction: column;
            }
        }
    </style>
</head>
<body>
    <h1>⚾ Rangers Baseball Bingo ⚾</h1>

    <div id="bingo-grid">
        <!-- Bingo cells will be dynamically inserted here -->
    </div>

    <div id="message"></div>

    <div class="button-container">
        <button id="new-game-btn" class="game-button">New Game</button>
        <button id="reset-progress-btn" class="game-button">Reset All Progress</button>
    </div>

    <script>
        // Array of baseball-related terms for the bingo card
        const BINGO_TERMS = [
            "Strikeout Looking", "Walk (BB)", "Stolen Base", "Sacrifice Fly",
            "Hit by Pitch", "Double Play", "Foul Tip Catch", "Mascot Dance",
            "Outfield Assist", "Catcher's Interference", "Pitching Change", "Manager Argument",
            "Fan Catches Foul Ball", "Home Run", "Single (1B)", "Double (2B)",
            "Triple (3B)", "Grand Slam", "Line Drive", "Ground Out",
            "Fly Out", "Pop Out", "Bunt Hit", "Tag Out",
            "Run Down", "Triple Play", "Error (E)", "Balk",
            "Wild Pitch", "Passed Ball", "Umpire Review", "First Pitch Strike",
            "Left on Base", "Pitcher Strikes Out Side", "Catcher Throws Out Runner", "Broken Bat",
            "100 MPH Pitch", "Spilled Drink", "Warning Track out", "Hit Foul Pole",
            "Announcer Messes Up", "Cute Baby on Jumbotron", "Dot Race", "The Wave",
            "RBI", "Mound Visit"
        ];

        const GRID_SIZE = 5;
        const NUM_CELLS = GRID_SIZE * GRID_SIZE;

        let currentBoard = []; // Stores the terms for the current game
        let markedCells = new Array(NUM_CELLS).fill(false); // Tracks which cells are marked

        const bingoGrid = document.getElementById('bingo-grid');
        const messageDisplay = document.getElementById('message');
        const newGameBtn = document.getElementById('new-game-btn');
        const resetProgressBtn = document.getElementById('reset-progress-btn');

        /**
         * Shuffles an array in place using the Fisher-Yates (Knuth) algorithm.
         * @param {Array} array The array to shuffle.
         */
        function shuffleArray(array) {
            for (let i = array.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [array[i], array[j]] = [array[j], array[i]];
            }
        }

        /**
         * Generates a new bingo board with unique terms.
         */
        function generateNewBoard() {
            // Shuffle a copy of the terms to avoid modifying the original array
            const shuffledTerms = [...BINGO_TERMS];
            shuffleArray(shuffledTerms);

            // Select the first NUM_CELLS unique terms
            currentBoard = shuffledTerms.slice(0, NUM_CELLS);
            markedCells.fill(false); // Reset marked cells for a new game
            saveProgress(); // Save the new, unmarked board
            renderBoard();
            messageDisplay.textContent = ''; // Clear any previous bingo message
        }

        /**
         * Renders the bingo board based on currentBoard and markedCells.
         */
        function renderBoard() {
            bingoGrid.innerHTML = ''; // Clear existing cells
            currentBoard.forEach((term, index) => {
                const cell = document.createElement('div');
                cell.classList.add('bingo-cell');
                cell.textContent = term;
                cell.dataset.index = index; // Store index for easy lookup

                if (markedCells[index]) {
                    cell.classList.add('marked');
                }

                cell.addEventListener('click', handleCellClick);
                bingoGrid.appendChild(cell);
            });
        }

        /**
         * Handles the click event on a bingo cell.
         * @param {Event} event The click event.
         */
        function handleCellClick(event) {
            const index = parseInt(event.target.dataset.index);
            if (isNaN(index)) {
                console.error("Invalid cell index clicked.");
                return;
            }

            // Toggle the marked state
            markedCells[index] = !markedCells[index];
            event.target.classList.toggle('marked', markedCells[index]);

            saveProgress(); // Save progress after each click
            checkForBingo();
        }

        /**
         * Checks for a bingo (row, column, or diagonal).
         */
        function checkForBingo() {
            const rows = [];
            const cols = [];
            const diagonals = [[], []]; // [mainDiagonal, antiDiagonal]

            // Initialize rows and columns
            for (let i = 0; i < GRID_SIZE; i++) {
                rows.push([]);
                cols.push([]);
            }

            // Populate rows, columns, and diagonals
            for (let i = 0; i < NUM_CELLS; i++) {
                const row = Math.floor(i / GRID_SIZE);
                const col = i % GRID_SIZE;

                rows[row].push(markedCells[i]);
                cols[col].push(markedCells[i]);

                if (row === col) {
                    diagonals[0].push(markedCells[i]); // Main diagonal
                }
                if (row + col === GRID_SIZE - 1) {
                    diagonals[1].push(markedCells[i]); // Anti-diagonal
                }
            }

            // Check if any line (row, col, diagonal) is all true (marked)
            const isBingo = rows.some(row => row.every(cell => cell)) ||
                            cols.some(col => col.every(cell => cell)) ||
                            diagonals.some(diag => diag.every(cell => cell));

            if (isBingo) {
                messageDisplay.textContent = "BINGO!";
                messageDisplay.style.opacity = 1;
            } else {
                messageDisplay.textContent = "";
                messageDisplay.style.opacity = 0;
            }
        }

        /**
         * Saves the current game state to localStorage.
         */
        function saveProgress() {
            try {
                localStorage.setItem('baseballBingoBoard', JSON.stringify(currentBoard));
                localStorage.setItem('baseballBingoMarkedCells', JSON.stringify(markedCells));
                console.log("Game progress saved.");
            } catch (e) {
                console.error("Failed to save progress to local storage:", e);
                // Optionally display a user-friendly message about storage failure
            }
        }

        /**
         * Loads the game state from localStorage.
         * @returns {boolean} True if progress was loaded, false otherwise.
         */
        function loadProgress() {
            try {
                const savedBoard = localStorage.getItem('baseballBingoBoard');
                const savedMarkedCells = localStorage.getItem('baseballBingoMarkedCells');

                if (savedBoard && savedMarkedCells) {
                    const parsedBoard = JSON.parse(savedBoard);
                    const parsedMarkedCells = JSON.parse(savedMarkedCells);

                    // Validate loaded data (e.g., correct size)
                    if (parsedBoard.length === NUM_CELLS && parsedMarkedCells.length === NUM_CELLS) {
                        currentBoard = parsedBoard;
                        markedCells = parsedMarkedCells;
                        renderBoard();
                        checkForBingo(); // Check for bingo on load in case it was achieved before
                        console.log("Game progress loaded.");
                        return true;
                    }
                }
            } catch (e) {
                console.error("Failed to load progress from local storage or data corrupted:", e);
                // Clear corrupted data to prevent persistent errors
                clearProgress();
            }
            return false;
        }

        /**
         * Clears all game progress from localStorage.
         */
        function clearProgress() {
            try {
                localStorage.removeItem('baseballBingoBoard');
                localStorage.removeItem('baseballBingoMarkedCells');
                console.log("All game progress cleared.");
            } catch (e) {
                console.error("Failed to clear progress from local storage:", e);
            }
        }

        // Event Listeners
        newGameBtn.addEventListener('click', generateNewBoard);
        resetProgressBtn.addEventListener('click', () => {
            // Confirm with the user before resetting all progress (no alert/confirm, use a simple message or visual cue if needed)
            if (confirm("Are you sure you want to reset all game progress? This cannot be undone.")) {
                 clearProgress();
                 generateNewBoard(); // Start a fresh game after clearing
            }
        });


        // Initial game setup on page load
        document.addEventListener('DOMContentLoaded', () => {
            // Try to load saved progress, if none, start a new game
            if (!loadProgress()) {
                generateNewBoard();
            }
        });
    </script>
</body>
</html>
